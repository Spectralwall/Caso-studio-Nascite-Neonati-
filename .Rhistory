#test di incorellazione
dwtest(mod9)
#il modello risulta eterostecastico e non normale
#per valutare sia leverers che outliars abbiamo la distanza di cook
cook<-cooks.distance(mod9)
# Cook's distance
par(mfrow=c(1,1))
plot(mod9, 5, id.n = 5)
plot(mod9, 4, id.n = 5)
max(cook)
#individuiamo valori che hanno distanza di cook molto alta e eliminiamoli
influential <- cook[(cook > (3 * mean(cook, na.rm = TRUE)))]
names_of_influential <- names(influential)
influential
neonati.filtrato <- neonati.filtrato %>% anti_join(neonati.filtrato[names_of_influential,])
mod9<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
plot(mod9,id.n = 10)
plot(mod9,id.n = 10)
par(mfrow=c(2,2))
plot(mod9,id.n = 10)
#Rieseguiamo i test
#test di normalita --> ipotes di normalita
shapiro.test(residuals(mod9))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod9)
#test di incorellazione
dwtest(mod9)
#per valutare sia leverers che outliars abbiamo la distanza di cook
cook<-cooks.distance(mod9)
# Cook's distance
par(mfrow=c(1,1))
plot(mod9, 5, id.n = 5)
plot(mod9, 4, id.n = 5)
influential <- cook[(cook > (3 * mean(cook, na.rm = TRUE)))]
names_of_influential <- names(influential)
influential
cook<-cooks.distance(mod9)
# Cook's distance
par(mfrow=c(1,1))
plot(mod9, 5, id.n = 5)
plot(mod9, 4, id.n = 5)
max(cook)
#individuiamo valori che hanno distanza di cook molto alta e eliminiamoli
influential <- cook[(cook > (10 * mean(cook, na.rm = TRUE)))]
names_of_influential <- names(influential)
influential
neonati.filtrato <- neonati.filtrato %>% anti_join(neonati.filtrato[names_of_influential,])
mod9<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod9)
par(mfrow=c(2,2))
plot(mod9,id.n = 10)
#Rieseguiamo i test
#test di normalita --> ipotes di normalita
shapiro.test(residuals(mod9))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod9)
#test di incorellazione
dwtest(mod9)
mod10<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
sqrt(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod10)
shapiro.test(residuals(mod10))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
mod10<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
#test di incorellazione
dwtest(mod10)
par(mfrow=c(2,2))
plot(mod10,id.n = 10)
mod10<- lm(sqrt(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod10)
plot(mod10,id.n = 10)
#test di incorellazione
dwtest(mod10)
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
shapiro.test(residuals(mod10))
mod10<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
(1/Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod10)
shapiro.test(residuals(mod10))
#test di incorellazione
dwtest(mod10)
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
plot(density(residuals(mod10)))
anova(mod9,mod10)
mod10<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
(1/Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
mod10<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
Cranio+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod10)
shapiro.test(residuals(mod10))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
mod10<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod10)
shapiro.test(residuals(mod10))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
mod10<- lm(log(Peso)~
N.gravidanze+
(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod10)
shapiro.test(residuals(mod10))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
mod10<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod10)
shapiro.test(residuals(mod10))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
#test di incorellazione
dwtest(mod10)
plot(mod10,id.n = 10)
par(mfrow=c(2,2))
plot(mod10,id.n = 10)
plot(mod9,id.n = 10)
plot(mod9, 5, id.n = 5)
plot(mod9, 4, id.n = 5)
# Cook's distance
par(mfrow=c(1,1))
plot(mod9, 5, id.n = 5)
plot(mod9, 4, id.n = 5)
mod10<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
sqrt(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod10)
mod10<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
(Cranio^2)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod10)
shapiro.test(residuals(mod10))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
mod10<- lm((Peso^2)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod10)
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
shapiro.test(residuals(mod10))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
mod10<- lm(log(10,Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod10)
shapiro.test(residuals(mod10))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
#test di incorellazione
dwtest(mod10)
par(mfrow=c(2,2))
plot(mod10,id.n = 10)
mod10<- lm(log(10,Peso)~
N.gravidanze+
log(10,Gestazione)+
log(10,Lunghezza)+
log(10,Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod10)
shapiro.test(residuals(mod10))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
#test di incorellazione
dwtest(mod10)
plot(mod10,id.n = 10)
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
mod9<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod9)
#Rieseguiamo i test
#test di normalita --> ipotes di normalita
shapiro.test(residuals(mod9))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod9)
mod9<- lm((1/Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod9)
#Rieseguiamo i test
#test di normalita --> ipotes di normalita
shapiro.test(residuals(mod9))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod9)
mod9<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
mod10 <- update(mod9,~.sqrt(Peso))
mod10 <- update(mod9,~. sqpr(Peso))
mod10 <- update(mod9,~.sqrt(Peso))
mod10 <- update(mod9,~.+sqrt(Peso))
summary(mod10)
#Rieseguiamo i test
#test di normalita --> ipotes di normalita
shapiro.test(residuals(mod10))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod10)
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod9)
#ma ce un problema nello studio di queste variabili,aho paura che alcune siano troppo correlate e diano problemi di multicollinearita
#mqa verifichiamolo, costruiamo un modello
mod1<- lm(Peso~
Anni.madre+
N.gravidanze+
Gestazione+
Lunghezza+
Cranio+
Fumatrici+
Tipo.parto+
Ospedale+
Sesso,
data=neonati.filtrato2)
#ma ce un problema nello studio di queste variabili,aho paura che alcune siano troppo correlate e diano problemi di multicollinearita
#mqa verifichiamolo, costruiamo un modello
mod1<- lm(Peso~
Anni.madre+
N.gravidanze+
Gestazione+
Lunghezza+
Cranio+
Fumatrici+
Tipo.parto+
Ospedale+
Sesso,
data=neonati.filtrato)
summary(mod1)
#test di normalita --> ipotes di normalita
shapiro.test(residuals(mod1))#Rifiutiamo il test di nornalita
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod1)#rifiutiamo ipotesi di non omoschedasticita (NOT STONCKS)
#test di incorellazione
dwtest(mod1)#Accetriamo ipoetesi (quindi non ce incorelazione)
mod9<- lm(Peso~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod9)
#Rieseguiamo i test
#test di normalita --> ipotes di normalita
shapiro.test(residuals(mod9))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod9)
mod9<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Anni.madre+
Sesso,
data=neonati.filtrato)
summary(mod9)
par(mfrow=c(2,2))
plot(mod9,id.n = 10)
#Rieseguiamo i test
#test di normalita --> ipotes di normalita
shapiro.test(residuals(mod9))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod9)
#test di incorellazione
dwtest(mod9)
#TENTATIVI RIMOZIONE ETEROSCHEDASTICITA
#proviamo ora a cambiare lo standard error con il robust standard error, per risolvere
#il problema di eteroschedasticità
coeftest(mod9, vcov = vcovHC(mod9, "HC1"))
#Rieseguiamo i test
#test di normalita --> ipotes di normalita
shapiro.test(residuals(mod9))
summary(mod9)
#TENTATIVI RIMOZIONE ETEROSCHEDASTICITA
#proviamo ora a cambiare lo standard error con il robust standard error, per risolvere
#il problema di eteroschedasticità
coeftest(mod9, vcov = vcovHC(mod9, "HC1"))
anova(mod9,coeftest(mod9, vcov = vcovHC(mod9, "HC1")))
#TENTATIVI RIMOZIONE ETEROSCHEDASTICITA
#proviamo ora a cambiare lo standard error con il robust standard error, per risolvere
coeftest(mod9, vcov = vcovHC(mod9, "HC1"))
summary(mod9)
mod9<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Fumatrici+
Sesso,
data=neonati.filtrato)
summary(mod9)
#Rieseguiamo i test
#test di normalita --> ipotes di normalita
shapiro.test(residuals(mod9))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod9)
#test di incorellazione
dwtest(mod9)
mod9<- lm(log(Peso)~
N.gravidanze+
log(Gestazione)+
log(Lunghezza)+
log(Cranio)+
Tipo.parto+
Sesso,
data=neonati.filtrato)
summary(mod9)
#Rieseguiamo i test
#test di normalita --> ipotes di normalita
shapiro.test(residuals(mod9))
#test di Omoschedasticità --> ipotesi di omoschedacita
bptest(mod9)
#test di incorellazione
dwtest(mod9)
plot(mod9,id.n = 10)
test <- data.frame(N.gravidanze = 3, Gestazione=39)
test
test
predict(mod9, test, se.fit = TRUE)
predict(mod9, newdata = test)
plot(x~y)
x <- rnorm(15)
y <- x + rnorm(15)
plot(x~y)
x
test <- data.frame(Anni.madre=NaN,N.gravidanze = 3,Fumatrici=NaN,
Gestazione=39,Peso=NaN,Lunghezza=NaN,Cranio=NaN,
Tipo.parto=NaN,Ospedale=NaN,Sesso=NaN)
test
predict(mod9, newdata = test)
test <- data.frame(Anni.madre=NaN,N.gravidanze = 3,Fumatrici=NaN,
Gestazione=39,Peso=NaN,Lunghezza=NaN,Cranio=NaN,
Tipo.parto="NaN",Ospedale=NaN,Sesso="NaN")
test
predict(mod9, newdata = test)
test <- data.frame(Anni.madre=NaN,N.gravidanze = 3,Fumatrici=NaN,
Gestazione=39,Peso=NaN,Lunghezza=NaN,Cranio=NaN,
Tipo.parto=NaN,Ospedale=NaN,Sesso="NaN")
test
predict(mod9, newdata = test)
summary(mod9)
test <- data.frame(Anni.madre=NaN,N.gravidanze = 3,Fumatrici=NaN,
Gestazione=39,Peso=NaN,Lunghezza=NaN,Cranio=NaN,
Tipo.parto="Ces",Ospedale=NaN,Sesso="NaN")
test
predict(mod9, newdata = test)
test <- data.frame(Anni.madre=NaN,N.gravidanze = 3,Fumatrici=NaN,
Gestazione=39,Peso=NaN,Lunghezza=NaN,Cranio=NaN,
Tipo.parto="Ces",Ospedale=NaN,Sesso="F")
test
predict(mod9, newdata = test)
test <- data.frame(N.gravidanze = 3,
Gestazione=39)
predict(mod9, newdata = test)
test <- data.frame(N.gravidanze = 3,Gestazione=39)
predict(mod9, newdata = test)
